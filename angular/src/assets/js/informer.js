!function(){"use strict";var t="/static/bundles/",e="https://s3.tradingview.com/",i={events:"external-embedding/embed-widget-events.js",hotlists:"external-embedding/embed-widget-hotlists.js",marketoverview:"external-embedding/embed-widget-market-overview.js",tickers:"external-embedding/embed-widget-tickers.js",forex_cross_rates:"external-embedding/embed-widget-forex-cross-rates.js",market_quotes:"external-embedding/embed-widget-market-quotes.js",forex_heat_map:"external-embedding/embed-widget-forex-heat-map.js",screener:"external-embedding/embed-widget-screener.js"};var n=function(e,i){var n=this;void 0===i&&(i="json"),this.pathname=("battle"===this._environment()?"/":t)+e,this.settingsFormat=i,this._findScripts().forEach(function(t){return n._replaceScript(t)})},r={embedWidgetSitePath:{configurable:!0},widgetName:{configurable:!0},propertiesToWorkWith:{configurable:!0},utmInfo:{configurable:!0},iframeSrcBase:{configurable:!0},propertiesToSkipInHash:{configurable:!0},propertiesToGetParams:{configurable:!0},cloudfrontHost:{configurable:!0}};r.embedWidgetSitePath.get=function(){throw new Error("Method must be overridden")},r.widgetName.get=function(){throw new Error("Method must be overridden")},r.propertiesToWorkWith.get=function(){return[]},r.utmInfo.get=function(){return{utm_source:location.hostname,utm_medium:"widget",utm_campaign:this.widgetName}},n.prototype._environment=function(){var t="www.tradingview.com"===location.host||"wwwcn.tradingview.com"===location.host||"dwq4do82y8xi7.cloudfront.net"===location.host||"s.tradingview.com"===location.host||"i18n.tradingview.com"===location.host||"partial.tradingview.com"===location.host||location.host.match(/^[a-z]{2}\.tradingview\.com/)||location.host.match(/prod-[^.]+.tradingview.com/)?"battle":-1!==location.href.indexOf("tradingview.com")?"staging":location.host.match(/webcharts/)?"staging_local":(location.host.match(/^localhost(:\d+)?$/),"local");return"local"===t&&null===location.host.match(/^localhost(:\d+)?$/)&&(t="battle"),t},n.prototype.filterRawSettings=function(t){var e=this.propertiesToSkipInHash.concat(this.propertiesToWorkWith),i={};return Object.keys(t).forEach(function(n){-1!==e.indexOf(n)&&(i[n]=t[n])}),i},r.iframeSrcBase.get=function(){var t="";return"battle"===this._environment()?t="https://s.tradingview.com":"staging"===this._environment()&&-1!==location.hostname.indexOf("beta.tradingview.com")&&(t="https://betacdn.tradingview.com"),this.settings.customer&&-1!==this.propertiesToSkipInHash.indexOf("customer")&&(t+="/"+this.settings.customer),t+this.embedWidgetSitePath},r.propertiesToSkipInHash.get=function(){return["locale"]},r.propertiesToGetParams.get=function(){return["locale","whitelabel"]},r.cloudfrontHost.get=function(){var t=document.createElement("a");return t.href=e,t.host},n.prototype._findScripts=function(){var t,e=document.getElementsByTagName("script"),i=[],n=null;for(t=e.length;t--;){var r=e[t].src;if(r){n||(n=document.createElement("a")),n.href=r;var o=("/"===n.pathname[0]?"":"/")+n.pathname,s=n.host===this.cloudfrontHost||"d33t3vvu2t2yu5.cloudfront.net"===n.host;o!==this.pathname||"battle"===this._environment()&&!s||i.push(e[t])}}return i},n.prototype._replaceScript=function(t){var e,i,n;if(this.script=t,"json"===this.settingsFormat?e=this._scriptContentToJSON():"stroke"===this.settingsFormat&&(e=t.innerHTML.trim()),e)if(this.settings=this.filterRawSettings(e),i=this.settings,n=this.utmInfo,Object.keys(n).forEach(function(t){i[t]=n[t]}),this._isValidSettings()){var r,o=isNaN(this.settings.height)?this.settings.height:this.settings.height+"px",s=isNaN(this.settings.width)?this.settings.width:this.settings.width+"px";this.script.parentNode&&this.script.parentNode.classList.contains("tradingview-widget-container")?this.iframeContainer=this.script.parentNode:this.iframeContainer=document.createElement("div"),this.iframeContainer.style.width=s,this.iframeContainer.style.height=o,this.iframeContainer.appendChild(((r=document.createElement("style")).innerHTML="\n\t.tradingview-widget-copyright {\n\t\tfont-size: 13px !important;\n\t\tline-height: 32px !important;\n\t\ttext-align: center !important;\n\t\tvertical-align: middle !important;\n\t\tfont-family: 'Trebuchet MS', Tahoma, Arial, sans-serif !important;\n\t\tcolor: #9db2bd !important;\n\t}\n\n\t.tradingview-widget-copyright .blue-text {\n\t\tcolor: #3bb3e4 !important;\n\t}\n\n\t.tradingview-widget-copyright a {\n\t\ttext-decoration: none !important;\n\t\tcolor: #9db2bd !important;\n\t}\n\n\t.tradingview-widget-copyright a:visited {\n\t\tcolor: #9db2bd !important;\n\t}\n\n\t.tradingview-widget-copyright a:hover .blue-text {\n\t\tcolor: #38acdb !important;\n\t}\n\n\t.tradingview-widget-copyright a:active .blue-text {\n\t\tcolor: #299dcd !important;\n\t}\n\n\t.tradingview-widget-copyright a:visited .blue-text {\n\t\tcolor: #3bb3e4 !important;\n\t}\n\t",r));var a=this._extractOldStyleEmbedCopyrightFromDOM(),c=a&&!this.settings.whitelabel,d=this.iframeContainer.querySelector(".tradingview-widget-copyright");d&&(this.settings.utm_medium="widget_new");var h=a||d?"calc("+o+" - 32px)":o;this.iframe=this._createIframe(h,s,t.id);var l=this.iframeContainer.querySelector(".tradingview-widget-container__widget");if(l?(this.script.parentNode.replaceChild(this.iframe,l),this.script.parentNode.removeChild(this.script)):(this.iframeContainer.appendChild(this.iframe),this.script.parentNode.replaceChild(this.iframeContainer,this.script)),c){var g=document.createElement("div");g.style.height="32px",g.style.lineHeight="32px",g.style.width=s,g.style.textAlign="center",g.style.verticalAlign="middle",g.innerHTML=a.innerHTML,this.iframeContainer.appendChild(g)}}else this._doEmergencyReplacement("Settings is not valid")},n.prototype._isValidSettings=function(){var t=function(t){if(void 0===t)return!0;var e=parseInt(t)+"%"==t+"";return parseInt(t)+""==t+""||e};return t(this.settings.width)&&t(this.settings.height)},n.prototype._buildGetQueryString=function(){var t=this,e=this.propertiesToGetParams.filter(function(e){return t.settings[e]}).map(function(e){return e+"="+t.settings[e]}).join("&");return e?"?"+e:""},n.prototype._buildHashString=function(t){var e=this,i={};return t&&(i.frameElementId=t),Object.keys(this.settings).forEach(function(t){-1===e.propertiesToSkipInHash.indexOf(t)&&(i[t]=e.settings[t])}),Object.keys(i).length>0?"#"+encodeURIComponent(JSON.stringify(i)):""},n.prototype._scriptContentToJSON=function(){var t=this.script.innerHTML.trim();try{return JSON.parse(t)}catch(t){return this._doEmergencyReplacement(),console.warn("Embed widget settings parse error: ",t),null}},n.prototype._createIframe=function(t,e,i){var n=document.createElement("iframe");i&&(n.id=i),this.settings.enableScrolling||n.setAttribute("scrolling","no"),n.setAttribute("allowtransparency",!0),n.setAttribute("frameborder",0),n.style.boxSizing="border-box",n.style.height=t,n.style.width=e;var r=this.iframeSrcBase+this._buildGetQueryString()+this._buildHashString(i);return n.setAttribute("src",r),n},n.prototype._doEmergencyReplacement=function(t){var e=document.createElement("div");e.innerHTML=t||"Something gone wrong",this.script.parentNode.replaceChild(e,this.script),this._extractOldStyleEmbedCopyrightFromDOM()},n.prototype._extractOldStyleEmbedCopyrightFromDOM=function(){return function(t){if(null===t)return null;var e=t.querySelector("#tradingview-copyright"),i=t.querySelector("#tradingview-quotes"),n=e||i;return n&&t.removeChild(n),n}(this.script.parentNode)},Object.defineProperties(n.prototype,r),new(function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={embedWidgetSitePath:{configurable:!0},widgetName:{configurable:!0},propertiesToWorkWith:{configurable:!0}};return i.embedWidgetSitePath.get=function(){return"/eventswidgetembed/"},i.widgetName.get=function(){return"events"},i.propertiesToWorkWith.get=function(){return["currencyFilter","importanceFilter","locale","width","height","whitelabel"]},Object.defineProperties(e.prototype,i),e}(n))(i.events)}();
